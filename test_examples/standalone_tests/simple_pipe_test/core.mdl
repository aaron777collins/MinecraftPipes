pack "Simple Pipe Test" description "Simple pipe system test examples" pack_format 82

namespace "test"

# Core lifecycle hooks
on_load "test:init"
on_tick "test:tick"

# Function tags for vanilla integration
tag function "minecraft:load":
    add "test:init"

tag function "minecraft:tick":
    add "test:tick"

function "init":
    # Initialize test scoreboards
    scoreboard objectives add test_tick dummy
    scoreboard objectives add test_status dummy
    
    # Set initial values
    scoreboard players set #global test_tick 0
    scoreboard players set #global test_status 0
    
    tellraw @a [{"text":"[TEST] Simple pipe test loaded!","color":"green"}]

function "tick":
    # Increment tick counter
    scoreboard players add #global test_tick 1
    
    # Test basic functionality every 100 ticks
    execute if score #global test_tick matches 100.. run function test:test_basic

function "test_basic":
    # Test basic pipe creation
    tellraw @a [{"text":"[TEST] Running basic pipe test...","color":"yellow"}]
    
    # Create a test source
    summon marker ~ ~ ~ {Tags:["test.source"],CustomName:'{"text":"Test Source","italic":false}'}
    
    # Create a test sink
    summon marker ~ ~5 ~ {Tags:["test.sink"],CustomName:'{"text":"Test Sink","italic":false}'}
    
    # Mark test as complete
    scoreboard players set #global test_status 1
    
    tellraw @a [{"text":"[TEST] Basic pipe test completed!","color":"green"}]

function "cleanup":
    # Clean up test entities
    kill @e[type=marker,tag=test.source]
    kill @e[type=marker,tag=test.sink]
    
    # Reset test status
    scoreboard players set #global test_status 0
    
    tellraw @a [{"text":"[TEST] Test cleanup completed!","color":"aqua"}]
